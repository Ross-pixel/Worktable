# Worktable — Architecture

## 1. Архитектурная модель

Worktable реализуется как:

Modular Monolith with Tenant Awareness

- Один backend.
- Изолированные модули.
- Ядро не знает реализации модулей.
- Все данные привязаны к user_id.

---

## 2. Слои системы

### 2.1 Core

Отвечает за:

- Регистрацию модулей
- Конфигурацию
- Безопасность
- Инициализацию приложения

Core не содержит бизнес-логики модулей.

---

### 2.2 Modules

Каждый модуль:

- Имеет собственные модели
- Имеет собственный сервисный слой
- Использует RepositoryInterface
- Экспортирует BaseModule

Структура:

modules/<module_name>/
    module.py
    models.py
    repository.py
    service.py
    routes.py

---

### 2.3 Infrastructure

- RepositoryInterface — контракт работы с данными.
- MemoryRepository — реализация для разработки.
- PostgresRepository — будущая реализация.

Бизнес-логика не знает конкретную БД.

---

## 3. Архитектурные инварианты

1. Модули не импортируют друг друга.
2. Роутеры не содержат бизнес-логики.
3. Работа с БД только через интерфейсы.
4. Ядро не зависит от конкретных модулей.
5. Любой модуль можно удалить без падения системы.

---

## 4. SaaS-готовность

С самого начала:

- Все сущности должны иметь user_id.
- Репозитории работают в user scope.
- Возможность добавить multi-user без переписывания логики.